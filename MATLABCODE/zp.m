clear;
A=[0 1 0 0;
    0 0 0 0;
    0 0 0 1;
    0 0 29.4 0];
B=[0 1 0 3]';
C=[1 0 0 0;
    0 0 1 0];
D=[0 0]';
J=[-10 0 0 0;
    0 -10 0 0;
    0 0 -2-2*sqrt(3)*1i 0;
    0 0 0 -2+2*sqrt(3)*1i];
pa=poly(A);
pj=poly(J);
S=[B A*B A^2*B A^3*B];
W=[pa(4) pa(3) pa(2) 1;
    pa(3) pa(2) 1 0;
    pa(2) 1 0 0;
    1 0 0 0];
P=S*W;
K=[pj(5)-pa(5) pj(4)-pa(4) pj(3)-pa(3) pj(2)-pa(2)]/P;
A=[0 1 0 0;0 0 0 0;0 0 0 1;0 0 29.4 0];
B=[0;1;0;3];
C=[1 0 0 0;0 0 1 0];
D=[0;0];
Ac=(A-B*K);
Bc=B;
Cc=C;
Dc=D;
[y,x,t]=impulse(Ac,Bc,Cc,Dc);
 
y1=y(:,1);y2=y(:,2);
h1=plot(t,y1,'r');
hold on;
h2=plot(t,y2,'bl');
grid;
xlabel('Time/s','FontSize',14);
hold on;
legend([h1,h2],'CarPos','Angel');
hold on;
% [tr,tp,ts]= pplot(y2,t);
% [tr1,tp1,ts1]= pplot2(y1,t);
